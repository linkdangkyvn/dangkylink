<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Unlocker Premium V3</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* CẤU HÌNH GIAO DIỆN */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { background: white; width: 90%; max-width: 450px; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); text-align: center; position: relative; overflow: hidden; }
        
        .step { display: none; animation: fadeIn 0.4s ease; }
        .step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { color: #2c3e50; margin: 0 0 5px 0; font-size: 20px; font-weight: 700; }
        p { color: #95a5a6; font-size: 14px; margin-bottom: 20px; }

        /* BUTTON STYLE */
        .btn { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; margin: 10px 0; border-radius: 12px; text-decoration: none; font-weight: 600; font-size: 15px; transition: 0.2s; cursor: pointer; border: none; width: 100%; box-sizing: border-box; position: relative; }
        .btn:active { transform: scale(0.98); }
        
        .btn-yt { background: #ff0000; color: white; box-shadow: 0 4px 10px rgba(255, 0, 0, 0.2); }
        .btn-zalo { background: #0068ff; color: white; box-shadow: 0 4px 10px rgba(0, 104, 255, 0.2); }
        
        /* Nút Quảng Cáo Đặc Biệt */
        .btn-ads { background: linear-gradient(45deg, #ff9900, #ffcc00); color: white; box-shadow: 0 4px 15px rgba(255, 153, 0, 0.3); border-bottom: 3px solid #e68a00; }

        /* Trạng thái Loading/Done */
        .btn.loading { background: #bdc3c7; pointer-events: none; justify-content: center; border-bottom: none; box-shadow: none; color: #555; }
        .btn.done { background: #27ae60; color: white; pointer-events: none; justify-content: center; border-bottom: none; box-shadow: none; }

        /* --- VÁCH NGĂN PHÂN CHIA (MỚI) --- */
        .divider { border-top: 2px dashed #e0e0e0; margin: 25px 0 15px 0; position: relative; }
        .divider::after { content: "Tiến trình"; background: white; padding: 0 10px; color: #bbb; font-size: 12px; position: absolute; top: -10px; left: 50%; transform: translateX(-50%); }

        /* NÚT NEXT (BÊN DƯỚI VÁCH NGĂN) */
        .btn-next { background: #dcdcdc; color: #888; pointer-events: none; justify-content: center; border-radius: 50px; padding: 16px; }
        .btn-next.unlocked { background: linear-gradient(135deg, #11998e, #38ef7d); color: white; pointer-events: auto; box-shadow: 0 5px 20px rgba(46, 204, 113, 0.4); animation: pulse 2s infinite; cursor: pointer; }
        
        /* THANH TIẾN TRÌNH TRÊN CÙNG */
        .progress-bg { background: #f1f2f6; height: 6px; border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        .progress-bar { height: 100%; background: #ff5e62; width: 0%; transition: width 0.4s; }

        .spinner { width: 18px; height: 18px; border: 3px solid #ccc; border-top-color: #333; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px; display: none; }
        .btn.loading .spinner { display: inline-block; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div class="container">
        <div class="progress-bg"><div class="progress-bar" id="myBar"></div></div>

        <div id="step1" class="step active">
            <h2>Bắt Đầu</h2>
            <p>Nhấn nút bên dưới để bắt đầu.</p>
            <div class="divider"></div>
            <button class="btn btn-next unlocked" onclick="chuyenTrang(2)">BẮT ĐẦU NGAY <i class="fas fa-arrow-right"></i></button>
        </div>

        <div id="step2" class="step">
            <h2>Bước 1/4</h2>
            <p>Đăng ký kênh để mở khóa</p>
            
            <a href="https://www.youtube.com/channel/ID_KENH_1?sub_confirmation=1" target="_blank" class="btn btn-yt" onclick="xuLyNhiemVu(this, 2, false)">
                <span><i class="fab fa-youtube"></i> Đăng Ký Kênh 1</span> <i class="fas fa-chevron-right"></i>
            </a>
            <a href="https://www.youtube.com/channel/ID_KENH_2?sub_confirmation=1" target="_blank" class="btn btn-yt" onclick="xuLyNhiemVu(this, 2, false)">
                <span><i class="fab fa-youtube"></i> Đăng Ký Kênh 2</span> <i class="fas fa-chevron-right"></i>
            </a>

            <div class="divider"></div>
            
            <button id="btn-next-2" class="btn btn-next" onclick="chuyenTrang(3)" data-required="2" data-done="0">
                <i class="fas fa-lock"></i> &nbsp; Hoàn thành 0/2
            </button>
        </div>

        <div id="step3" class="step">
            <h2>Bước 2/4</h2>
            <p>Ủng hộ thêm kênh phụ</p>
            <a href="https://www.youtube.com/channel/ID_KENH_3?sub_confirmation=1" target="_blank" class="btn btn-yt" onclick="xuLyNhiemVu(this, 3, false)">
                <span><i class="fab fa-youtube"></i> Đăng Ký Kênh 3</span> <i class="fas fa-chevron-right"></i>
            </a>
            <a href="https://www.youtube.com/channel/ID_KENH_4?sub_confirmation=1" target="_blank" class="btn btn-yt" onclick="xuLyNhiemVu(this, 3, false)">
                <span><i class="fab fa-youtube"></i> Đăng Ký Kênh 4</span> <i class="fas fa-chevron-right"></i>
            </a>

            <div class="divider"></div>

            <button id="btn-next-3" class="btn btn-next" onclick="chuyenTrang(4)" data-required="2" data-done="0">
                <i class="fas fa-lock"></i> &nbsp; Hoàn thành 0/2
            </button>
        </div>

        <div id="step4" class="step">
            <h2>Bước 3/4</h2>
            <p>Tham gia nhóm & Xác minh</p>
            
            <a href="https://zalo.me/g/LINK_NHOM" target="_blank" class="btn btn-zalo" onclick="xuLyNhiemVu(this, 4, false)">
                <span><i class="fas fa-users"></i> Tham gia Zalo</span> <i class="fas fa-chevron-right"></i>
            </a>
            
            <a href="LINK_DIRECT_ADSTERRA" target="_blank" class="btn btn-ads" onclick="xuLyNhiemVu(this, 4, true)">
                <span><i class="fas fa-star"></i> Link Nhà Tài Trợ (Click)</span> <i class="fas fa-external-link-alt"></i>
            </a>

            <div class="divider"></div>

            <button id="btn-next-4" class="btn btn-next" onclick="chuyenTrang(5)" data-required="2" data-done="0">
                <i class="fas fa-lock"></i> &nbsp; Hoàn thành 0/2
            </button>
        </div>

        <div id="step5" class="step">
            <h2 style="color: #27ae60;">Thành Công!</h2>
            <p>Link đã sẵn sàng.</p>
            <div class="divider"></div>
            <a href="#" id="finalLink" class="btn btn-next unlocked">
                <i class="fas fa-download"></i> &nbsp; TẢI FILE NGAY
            </a>
        </div>
    </div>

    <script>
        // Hàm Xử Lý Nhiệm Vụ (Có chế độ đếm ngược cho Quảng cáo)
        function xuLyNhiemVu(el, step, isAd) {
            if (el.classList.contains('done') || el.classList.contains('loading')) return;

            el.classList.add('loading');
            let contentSpan = el.querySelector('span');
            let oldText = contentSpan.innerText;
            el.querySelector('i.fa-chevron-right, i.fa-external-link-alt').style.display = 'none';

            if (isAd) {
                // --- LOGIC CHO QUẢNG CÁO (Đếm 5 giây) ---
                let count = 5;
                contentSpan.innerText = `Vui lòng chờ ${count}s...`;
                
                let timer = setInterval(() => {
                    count--;
                    contentSpan.innerText = `Vui lòng chờ ${count}s...`;
                    if (count <= 0) {
                        clearInterval(timer);
                        finishTask(el, step);
                    }
                }, 1000);
            } else {
                // --- LOGIC THƯỜNG (Giả vờ check 2 giây) ---
                contentSpan.innerText = "Đang kiểm tra...";
                setTimeout(() => { finishTask(el, step); }, 2000);
            }
        }

        function finishTask(el, step) {
            el.classList.remove('loading');
            el.classList.add('done');
            el.innerHTML = '<i class="fas fa-check"></i> &nbsp; Đã hoàn thành';
            checkNext(step);
        }

        function checkNext(step) {
            let btn = document.getElementById('btn-next-' + step);
            let req = parseInt(btn.dataset.required);
            let done = parseInt(btn.dataset.done) + 1;
            btn.dataset.done = done;
            btn.innerHTML = `<i class="fas fa-lock"></i> &nbsp; Hoàn thành ${done}/${req}`;

            if (done >= req) {
                btn.classList.add('unlocked');
                btn.innerHTML = `TIẾP TỤC <i class="fas fa-arrow-right"></i>`;
            }
        }

        function chuyenTrang(n) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('step' + n).classList.add('active');
            document.getElementById('myBar').style.width = ((n-1)*25) + "%";
        }

        // Lấy link
        const p = new URLSearchParams(window.location.search);
        const l = p.get('link') || (p.get('id') ? atob(p.get('id')) : null);
        document.getElementById('finalLink').href = l || "https://google.com";
    </script>
</body>
</html>
